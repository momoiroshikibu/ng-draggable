angular.module("ng-draggable",[]).directive("ngDrag",["$rootScope","$parse","$document",function(t,e,n){return{restrict:"A",link:function(o,a,r){var c,l,u,i,f="ontouchstart"in document.documentElement,d="touchstart mousedown",s="touchmove mousemove",g="touchend mouseup",p=null,m=null,y=e(r.ngDrag)||null,b=function(){a.attr("draggable","false"),$(!0)},$=function(t){t&&(o.$on("$destroy",v),o.$watch(r.ngDrag,x),a.on(d,h),f||a.on("mousedown",function(){return!1}))},v=function(){$(!1)},x=function(t){p=t},h=function(t){f?(X(),m=setTimeout(function(){X(),Y(t)},100),n.on(s,X),n.on(g,X)):Y(t)},X=function(){clearTimeout(m),n.off(s,X),n.off(g,X)},Y=function(e){e.preventDefault(),a[0].style.width=a[0].offsetWidth+"px",a[0].style.height=a[0].offsetHeight+"px",a.centerX=e.offsetX||e.layerX,a.centerY=e.offsetY||e.layerY,a.addClass("dragging"),c=e.pageX||e.clientX+n[0].body.scrollLeft,l=e.pageY||e.clientY+n[0].body.scrollTop,u=c-a.centerX-n[0].body.scrollLeft,i=l-a.centerY-n[0].body.scrollTop,w(u,i),n.on(s,D),n.on(g,C),t.$broadcast("draggable:start",{x:c,y:l,tx:u,ty:i,element:a,data:p})},D=function(e){e.preventDefault(),c=e.pageX||e.clientX+n[0].body.scrollLeft,l=e.pageY||e.clientY+n[0].body.scrollTop,u=c-a.centerX-n[0].body.scrollLeft,i=l-a.centerY-n[0].body.scrollTop,w(u,i),t.$broadcast("draggable:move",{x:c,y:l,tx:u,ty:i,element:a,data:p})},C=function(e){e.preventDefault(),t.$broadcast("draggable:end",{x:c,y:l,tx:u,ty:i,element:a,data:p,callback:T}),a.removeClass("dragging"),k(),n.off(s,D),n.off(g,C)},T=function(t){y&&o.$apply(function(){y(o,{$data:p,$event:t})})},k=function(){a.css({left:"",top:"",position:"","z-index":""})},w=function(t,e){a.css({left:t+"px",top:e+"px"})};b()}}}]).directive("ngDrop",["$parse","$timeout",function(t){return{restrict:"A",link:function(e,n,o){var a=t(o.ngDrop),r=function(){c(!0)},c=function(t){t&&(e.$on("$destroy",l),e.$on("draggable:start",u),e.$on("draggable:move",i),e.$on("draggable:end",f))},l=function(){c(!1)},u=function(t,e){d(e.x,e.y,e.element)},i=function(t,e){d(e.x,e.y,e.element)},f=function(t,n){d(n.x,n.y,n.element)&&(n.callback&&n.callback(t),e.$apply(function(){a(e,{$data:n.data,$event:t})})),s(!1,n.element)},d=function(t,e,n){var o=g(t,e);return s(o,n),o},s=function(t,e){t?(n.addClass("drag-enter"),e.addClass("drag-over")):(n.removeClass("drag-enter"),e.removeClass("drag-over"))},g=function(t,e){var o=n[0].getBoundingClientRect();return t>=o.left&&t<=o.right&&e<=o.bottom&&e>=o.top};r()}}}]);