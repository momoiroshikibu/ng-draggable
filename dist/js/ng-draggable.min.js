angular.module("ng-draggable",[]).directive("ngDrag",["$rootScope","$parse","$document",function(t,e,n){return{restrict:"A",link:function(o,a,r){var c,i,u,l,g="ontouchstart"in document.documentElement,f="touchstart mousedown",d="touchmove mousemove",s="touchend mouseup",p=null,m=!1,v=null,$=e(r.ngDrag)||null,b=function(){a.attr("draggable","false"),y(!0)},y=function(t){t&&(o.$on("$destroy",h),r.$observe("ngDrag",D),o.$watch(r.ngDragData,x),a.on(f,C),g||a.on("mousedown",function(){return!1}))},h=function(){y(!1)},x=function(t){p=t},D=function(t){m=o.$eval(t)},C=function(t){m&&(g?(X(),v=setTimeout(function(){X(),Y(t)},100),n.on(d,X),n.on(s,X)):Y(t))},X=function(){clearTimeout(v),n.off(d,X),n.off(s,X)},Y=function(e){m&&(e.preventDefault(),a.centerX=a[0].offsetWidth/2,a.centerY=a[0].offsetHeight/2,a.addClass("dragging"),c=e.pageX||e.originalEvent.touches[0].pageX,i=e.pageY||e.originalEvent.touches[0].pageY,u=c-a.centerX-n[0].body.scrollLeft,l=i-a.centerY-n[0].body.scrollTop,z(u,l),n.on(d,k),n.on(s,E),t.$broadcast("draggable:start",{x:c,y:i,tx:u,ty:l,element:a,data:p}))},k=function(e){m&&(e.preventDefault(),c=e.pageX||e.originalEvent.touches[0].pageX,i=e.pageY||e.originalEvent.touches[0].pageY,u=c-a.centerX-n[0].body.scrollLeft,l=i-a.centerY-n[0].body.scrollTop,z(u,l),t.$broadcast("draggable:move",{x:c,y:i,tx:u,ty:l,element:a,data:p}))},E=function(e){m&&(e.preventDefault(),t.$broadcast("draggable:end",{x:c,y:i,tx:u,ty:l,element:a,data:p,callback:T}),a.removeClass("dragging"),w(),n.off(d,k),n.off(s,E))},T=function(t){$&&o.$apply(function(){$(o,{$data:p,$event:t})})},w=function(){a.css({left:"",top:"",position:"","z-index":""})},z=function(t,e){a.css({left:t,top:e,position:"fixed","z-index":99999})};b()}}}]).directive("ngDrop",["$parse","$timeout",function(t){return{restrict:"A",link:function(e,n,o){var a=t(o.ngDrop),r=function(){c(!0)},c=function(t){t&&(e.$on("$destroy",i),e.$on("draggable:start",u),e.$on("draggable:move",l),e.$on("draggable:end",g))},i=function(){c(!1)},u=function(t,e){f(e.x,e.y,e.element)},l=function(t,e){f(e.x,e.y,e.element)},g=function(t,n){f(n.x,n.y,n.element)&&(n.callback&&n.callback(t),e.$apply(function(){a(e,{$data:n.data,$event:t})})),d(!1,n.element)},f=function(t,e,n){var o=s(t,e);return d(o,n),o},d=function(t,e){t?(n.addClass("drag-enter"),e.addClass("drag-over")):(n.removeClass("drag-enter"),e.removeClass("drag-over"))},s=function(t,e){var o=n[0].getBoundingClientRect();return o.right=o.left+n[0].outerWidth,o.bottom=o.top+n[0].outerHeight,t>=o.left&&t<=o.right&&e<=o.bottom&&e>=o.top};r()}}}]);